<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.shape.SVGPath?>
<?import javafx.scene.Group?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="de.levingamer8.modlauncher.ui.Controller"
            styleClass="root">

    <!-- TOP BAR: Left title | Center global actions | Right account -->
    <top>
        <HBox styleClass="topbar" alignment="CENTER_LEFT" spacing="14">
            <!-- Left -->
            <VBox spacing="2">
                <Label text="ModLauncher" styleClass="h1"/>
                <HBox spacing="8" alignment="CENTER_LEFT">
                    <Label text="made by LevinGamer8" styleClass="mutedSmall"/>
                    <Label fx:id="versionLabel" styleClass="version"/>
                </HBox>
            </VBox>

            <Region HBox.hgrow="ALWAYS"/>

            <!-- Center: Global actions -->
            <HBox spacing="10" alignment="CENTER">
                <Button fx:id="launcherUpdateButton"
                        text="Launcher aktualisieren"
                        onAction="#onLauncherUpdate"
                        styleClass="ghost actionButton"/>

                <Button fx:id="openMainFolderButton"
                        text="Main-Ordner öffnen"
                        onAction="#onOpenMainFolder"
                        styleClass="ghost actionButton"/>
                <Button fx:id="hostModeButton"
                        text="Host-Mode"
                        onAction="#onHostMode"
                        styleClass="ghost actionButton"/>
            </HBox>

            <Region HBox.hgrow="ALWAYS"/>

            <!-- Right: Account widget -->
            <HBox spacing="12" alignment="CENTER_RIGHT">
                <VBox alignment="CENTER_RIGHT" spacing="6">
                    <Label fx:id="statusLabel" text="Bereit" styleClass="pillOk"/>
                    <ProgressBar fx:id="progressBar" visible="false" progress="-1" styleClass="progressSlim"/>
                </VBox>

                <HBox spacing="10" alignment="CENTER_RIGHT" styleClass="card">
                    <ImageView fx:id="skinView" fitWidth="28" fitHeight="28" preserveRatio="true" smooth="true"/>
                    <VBox spacing="2">
                        <Label fx:id="accountNameLabel" text="" styleClass="sectionTitle"/>
                        <Label fx:id="loginStatusLabel" text="Nicht eingeloggt" styleClass="mutedSmall"/>
                    </VBox>
                    <Button fx:id="loginButton"
                            text="Login (Microsoft)"
                            onAction="#onAccountButton"
                            styleClass="secondary"/>
                </HBox>
            </HBox>
        </HBox>
    </top>

    <!-- MAIN CONTENT -->
    <center>
        <SplitPane fx:id="mainSplit" orientation="VERTICAL" dividerPositions="0.88" styleClass="mainSplit">
            <items>

                <!-- TOP AREA -->
                <HBox spacing="16" styleClass="contentRoot">

                    <!-- INSTANCE AREA (center focus) -->
                    <VBox spacing="14" HBox.hgrow="ALWAYS">

                        <!-- Instance control card -->
                        <VBox styleClass="card" spacing="12">
                            <HBox alignment="CENTER_LEFT" spacing="10">
                                <Label text="Instanz" styleClass="sectionTitle"/>
                                <Region HBox.hgrow="ALWAYS"/>

                                <!-- Profile action icons -->
                                <Button onAction="#onNewProfile" styleClass="iconBtn">
                                    <graphic>
                                        <SVGPath content="M12 5v14 M5 12h14"
                                                 style="-fx-stroke: #00ffff; -fx-stroke-width: 2.4; -fx-fill: transparent; -fx-stroke-line-cap: round; -fx-stroke-line-join: round;"/>
                                    </graphic>
                                </Button>

                                <Button onAction="#onEditProfile" styleClass="iconBtn">
                                    <graphic>
                                        <SVGPath content="M5 19l3.5-1 9-9-2.5-2.5-9 9L5 19z M13 6l2.5 2.5"
                                                 style="-fx-stroke: #00ffff; -fx-stroke-width: 2.4; -fx-fill: transparent; -fx-stroke-line-cap: round; -fx-stroke-line-join: round;"/>
                                    </graphic>
                                </Button>

                                <Button onAction="#onDuplicateProfile" styleClass="iconBtn">
                                    <graphic>
                                        <SVGPath content="M8 8h10v10H8z M6 16H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"
                                                 style="-fx-stroke: #00ffff; -fx-stroke-width: 2.4; -fx-fill: transparent; -fx-stroke-line-cap: round; -fx-stroke-line-join: round;"/>
                                    </graphic>
                                </Button>

                                <Button onAction="#onDeleteProfile" styleClass="iconBtn iconBtnDanger">
                                    <graphic>
                                        <Group>
                                            <SVGPath content="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"
                                                     styleClass="iconDelete"
                                                     scaleX="0.04"
                                                     scaleY="0.04"/>
                                        </Group>
                                    </graphic>
                                </Button>
                            </HBox>

                            <!-- Instance selector -->
                            <ComboBox fx:id="profileCombo"/>

                            <!-- Main instance actions -->
                            <HBox spacing="10">
                                <Button fx:id="updateButton"
                                        text="Modpack aktualisieren"
                                        onAction="#onUpdate"
                                        styleClass="secondary actionButton"/>
                                <Button fx:id="openFolderButton"
                                        text="Instanz-Ordner"
                                        onAction="#onOpenFolder"
                                        styleClass="ghost actionButton"/>
                                <Button fx:id="playButton"
                                        text="Start"
                                        onAction="#onPlay"
                                        styleClass="primaryBig actionButton" HBox.hgrow="ALWAYS"/>
                            </HBox>
                        </VBox>

                        <!-- Übersicht kleiner rechts/unten -->
                        <VBox styleClass="card" spacing="10" VBox.vgrow="ALWAYS">
                            <HBox alignment="CENTER_LEFT" spacing="10">
                                <Label text="Übersicht" styleClass="sectionTitle"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label text="Live" styleClass="pillOk"/>
                            </HBox>

                            <TabPane tabClosingPolicy="UNAVAILABLE" styleClass="tabs" VBox.vgrow="ALWAYS">
                                <tabs>
                                    <Tab text="Changelog">
                                        <VBox spacing="10" styleClass="pad16" VBox.vgrow="ALWAYS">
                                            <TextArea fx:id="changelogArea" editable="false" wrapText="true"
                                                      styleClass="logArea" VBox.vgrow="ALWAYS"/>
                                        </VBox>
                                    </Tab>
                                    <Tab text="Server">
                                        <VBox spacing="10" styleClass="pad16" VBox.vgrow="ALWAYS">
                                            <HBox spacing="10" alignment="CENTER_LEFT">
                                                <Label text="Status:" styleClass="mutedSmall"/>
                                                <Label fx:id="serverStatusLabel" text="Unbekannt" styleClass="pillError"/>
                                            </HBox>
                                            <Label fx:id="serverDetailsLabel"
                                                   text="Noch kein Check implementiert."
                                                   styleClass="muted"/>
                                        </VBox>
                                    </Tab>
                                    <Tab text="Modpack">
                                        <VBox spacing="10" styleClass="pad16" VBox.vgrow="ALWAYS">
                                            <Label fx:id="packInfoLabel"
                                                   text="Hier Pack-Infos anzeigen."
                                                   styleClass="muted"/>
                                        </VBox>
                                    </Tab>
                                </tabs>
                            </TabPane>
                        </VBox>

                    </VBox>
                </HBox>

                <!-- BOTTOM AREA: LOG -->
                <VBox styleClass="contentRoot">
                    <TitledPane fx:id="logPane" text="Details (Log)" expanded="false" styleClass="titledCard">
                        <content>
                            <VBox styleClass="card" spacing="10">
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <Region HBox.hgrow="ALWAYS"/>
                                    <Button text="Kopieren" onAction="#onCopyLog" styleClass="ghost actionButton"/>
                                    <Button text="Leeren" onAction="#onClearLog" styleClass="ghostDanger actionButton"/>
                                </HBox>

                                <TextArea fx:id="logArea"
                                          editable="false"
                                          wrapText="false"
                                          styleClass="logArea"
                                          VBox.vgrow="ALWAYS"/>
                            </VBox>
                        </content>
                    </TitledPane>
                </VBox>

            </items>
        </SplitPane>
    </center>

</BorderPane>
